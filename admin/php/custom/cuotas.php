<?php class Cuota extends Tabla {	public function customFunc($post) {		global $config, $crlf;			switch ($post['field']) {			case 'Generar':				$strSQL = "SELECT c.NumeClie, c.ValoCuot, e.ImpoAdmi, e.ImpoOtro";				$strSQL.= $crlf." FROM clientes c";				$strSQL.= $crlf." INNER JOIN empresas e ON c.NumeEmpr = e.NumeEmpr";				if ($post["dato"]["Empresa"] != '') {					$strSQL.= $crlf." WHERE e.NumeEmpr = ". $post["dato"]["Empresa"];				}				$strSQL.= $crlf." ORDER BY c.NumeEmpr, c.NumeClie";								$clientes = $config->cargarTabla($strSQL);				if ($clientes) {					while ($fila = $clientes->fetch_assoc()) {						$NumePago = $config->buscarDato("SELECT COALESCE(MAX(NumePago), 0) + 1 FROM pagos");												$strSQL = "INSERT INTO pagos(NumePago, FechPago, NumeClie, NumeEstaPago, NumeTipoPago, CodiBarr, FechVenc, ImpoPura, ImpoAdmi, ImpoOtro)";						$strSQL.= " VALUES($NumePago, SYSDATE(), {$fila['NumeClie']}, 0, 1, '', STR_TO_DATE('{$post['dato']['Fecha']}-10', '%Y-%m-%d'), {$fila['ValoCuot']}, {$fila['ImpoAdmi']}, {$fila['ImpoOtro']})";												$result = $config->ejecutarCMD($strSQL);												if ($result !== true) {							continue;						}					}				}					if ($result === true) {					return "Datos actualizados!";				}				else {					return "Error al actualizar los datos.<br>".$result;				}					break;							case "ImpoTota":				$strSQL = "SELECT ImpoPura + ImpoAdmi + ImpoOtro FROM pagos WHERE NumePago = ". $post["dato"];								return $config->buscarDato($strSQL);				break;		}		}		public function listar($strFiltro="") {		echo '<button type="button" class="btn btn-sm btn-info marginBottom10"><i class="fa fa-fw fa-print" aria-hidden="true"></i> Imprimir</button>';				parent::listar($strFiltro);	}}?>